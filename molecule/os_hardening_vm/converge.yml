---
- name: wrapper playbook for kitchen testing "ansible-os-hardening" with custom vars for testing
  hosts: all
  become: true
  environment:
    http_proxy: "{{ lookup('env', 'http_proxy') | default(omit)  }}"
    https_proxy: "{{ lookup('env', 'https_proxy') | default(omit) }}"
    no_proxy: "{{ lookup('env', 'no_proxy') | default(omit) }}"
  collections:
    - devsec.hardening
  tasks:
    - include_role:
        name: os_hardening
  vars:
    os_auth_pam_passwdqc_enable: false
    os_auth_lockout_time: 15
    os_yum_repo_file_whitelist: ['foo.repo']

# - name: wrapper playbook for kitchen testing "ansible-os-hardening"
#  hosts: all
#  become: true
#  collections:
#    - devsec.hardening
#  vars:
#    os_auditd_enabled: false
#  tasks:
#    - name: set ansible_python_interpreter to "/usr/bin/python3" on fedora
#      set_fact:
#        ansible_python_interpreter: "/usr/bin/python3"
#      when: ansible_facts.distribution == 'Fedora'
#
#    - name: Run the equivalent of "apt-get update" as a separate step
#      apt:
#        update_cache: yes
#      when: ansible_facts.os_family == 'Debian'
#
#    - include_role:
#        name: os_hardening
